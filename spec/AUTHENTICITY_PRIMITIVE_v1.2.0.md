# AUTHENTICITY PRIMITIVE v1.2.0

**Spark Processor — PQC量子耐性アンカー構造の不変核**

バージョン: 1.2.0  
作成日: 2026-02-27  
ライセンス: CC0 1.0 Universal（パブリックドメイン）

---

## 正式定義

**Authenticity Primitive v1.2.0** は、任意のデータを決定論的に正準化し、  
Merkleルートを導出し、PQC署名検証入力とするための **最小規則セット** である。

---

## 目的

量子コンピュータ時代において、データの真正性を「改ざんが即座に検知される」形で  
長期にわたって保証すること。

記録媒体や時間の経過に依存せず、**誰でも再計算により検証可能な数学的基盤** を提供する。

---

## Level 0 — 不変核（Immutable Core）

以下の **4規則のみ** を固定する。それ以外の実装詳細はこのファイルの対象外とする。

| 規則番号 | 規則名 | 内容 |
|:--------:|--------|------|
| **Rule 1** | **Canonical Serialization Rule**<br>（正準シリアライズ規則） | 入力データを CBOR（RFC 8949 Strict Canonical Encoding）でエンコードする。<br>・マップキーは UTF-8 バイト順で厳密にソートする<br>・空白・改行・浮動小数点表現の曖昧性を完全に排除する<br>・`bool` 型は `int` 型より先に判定する（Python等サブクラス問題の回避） |
| **Rule 2** | **Merkle Tree Construction Rule**<br>（Merkleツリー構築規則） | ・葉ノード：正準化済みバイト列を SHA3-512 でハッシュ化する（64バイト固定長）<br>・内部ノード：左右の子ハッシュを連結後 SHA3-512 でハッシュ化する<br>・奇数ノードの場合は末尾ノードを自身と連結して処理する<br>・葉のソート順：UTF-8 バイト順（型混在時は正準化後のバイト列でソート） |
| **Rule 3** | **Signature Input Formation Rule**<br>（署名入力形成規則） | PQC署名の対象は以下3要素を正準シリアライズしたバイト列とする：<br>1. 正準化済み Merkle Root（bytes）<br>2. SpecGenesisHash（bytes）<br>3. RFC 3339 形式タイムスタンプ（例: `2026-02-27T00:00:00Z`） |
| **Rule 4** | **Verification Procedure**<br>（検証手順） | 以下の順序で全ステップを実行し、全て合格した場合のみ `true` を返す：<br>1. SpecGenesisHash が `CURRENT_SPEC_GENESIS_HASH` と一致することを確認<br>2. 同一正準化ルールによる Merkle Root の再計算<br>3. PQC 公開鍵による署名検証<br>4. MerklePath が存在する場合はパス検証も実施 |

> ⚠️ **検証手順の順序について**  
> Rule 4 の検証ステップは記載順に実行しなければならない。  
> 特に SpecGenesisHash の確認（ステップ1）は、署名検証（ステップ3）より**必ず先**に行うこと。

---

## 不変性の保証

このファイル自体のハッシュ（SpecGenesisHash）がシステム内に記録される。  
ファイルの内容が1ビットでも変化した場合、全ての検証が即座に失敗する。

```
CURRENT_SPEC_GENESIS_HASH = SHA3-512(このファイルの正準化済みバイト列)
```

---

## 関連ファイル

| ファイル | 内容 |
|----------|------|
| [`MINIMAL_VERIFIER_v1.2.0.md`](./MINIMAL_VERIFIER_v1.2.0.md) | 言語非依存の疑似コード実装（182行）。上記4規則の参照実装。 |

---

## 変更履歴

| バージョン | 日付 | 内容 |
|-----------|------|------|
| 1.2.0 | 2026-02-27 | 初版リリース |

---

**このファイルは Spark Processor の魂です。  
いかなる実装・言語・時代においても、これらの規則は不変です。**

---

*ライセンス: CC0 1.0 Universal — このファイルはパブリックドメインです。*

